<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>风不二 | 会工作&amp;爱生活</title>

  
  <meta name="author" content="ibeeger">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="风不二"/>

  
  <meta property="og:image" content="/blog/favicon.ico"/>
  

  <link href="/blog/favicon.ico" rel="icon">
  <link rel="alternate" href="/blog/atom.xml" title="风不二" type="application/atom+xml">
  <link rel="stylesheet" href="/blog/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/blog/">风不二</a>
    </h1>
    <p class="site-description">会工作&amp;爱生活</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/blog/">Home</a></li>
      
        <li><a href="/blog/archives">Archives</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/blog/2018/01/04/api/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2018/01/04/api/" rel="bookmark">
        <time class="entry-date published" datetime="2018-01-04T05:59:22.000Z">
          2018-01-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>前后端约定</p>
<p>###和服务端相关：<br>1、字段、含义统一 （字典建立起来，先查字典）=== （系统内统一）</p>
<p> 举例：  </p>
<blockquote>
<p>userId: 用户id<br>workId: 作业id<br>workName: 作业名称<br>exerciseId: </p>
</blockquote>
<p>2、路由（params, query可以利用起来）        </p>
<ul>
<li>params</li>
<li>query</li>
</ul>
<p>3、数据传输（空值字段）            </p>
<ul>
<li>方案1、不参与交互传输  </li>
<li>方案2、参与交互传输、需要定义不同类型的 default  value 的方案 ===（确定方案） </li>
</ul>
<p>4、code值定义  1、用户提示 2、排插问题<br>    对前端来说区分出来异常和空就可以</p>
<p>5、数据中只包含用到的字段。(轻|重)</p>
<p>###和前端相关：</p>
<p>1、先定义组件 然后安装到项目使用</p>
<p>2、组件 props 类型要声明</p>
<ul>
<li>array  React.PropTypes.array  //数组</li>
<li>bool  React.PropTypes.bool.isRequired //布尔值 而且是必须的</li>
<li>func  React.PropTypes.func //函数</li>
<li>number  //数字</li>
<li>object  //对象</li>
<li>string  //字符串</li>
<li>any  //任何类型  number string  elements  array</li>
<li>arrayOf  //</li>
<li>element  //React 元素</li>
<li>instanceOf </li>
<li>node </li>
<li>objectOf </li>
<li>oneOf </li>
<li>oneOfType </li>
<li>shape    </li>
</ul>
<p>3、package.json  name 定义 必须是以下三个组下</p>
<ul>
<li>@ht, </li>
<li>@httest, </li>
<li>@person</li>
</ul>
<p>举例：定义userInfo的组件</p>
<pre>{
   'name' : '@ht/userInfo'
    ...
 }</pre> 

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2017/12/27/copycontent/"><span>【linux】复制文本命令</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2017/12/27/copycontent/" rel="bookmark">
        <time class="entry-date published" datetime="2017-12-27T05:49:17.000Z">
          2017-12-27
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>经常在终端下操作的同学，应该很经常用到复制一些文本或者日志，<br>比如下面</p>
<p>cat file.log | grep “xxxxxxxx” </p>
<p>获得文本后复制，如果内容超过一屏，复制起来就比较麻烦，今天从网上搜了下还真有直接复制到剪切板上的。</p>
<p>具体介绍</p>
<p>#Windows下<br>使用系统自带的clip命令。</p>
<h3 id="位于C-Windows-system32-clip-exe。"><a href="#位于C-Windows-system32-clip-exe。" class="headerlink" title="位于C:\Windows\system32\clip.exe。"></a>位于C:\Windows\system32\clip.exe。</h3><p>示例：</p>
<blockquote>
<p>echo Hello | clip </p>
</blockquote>
<h3 id="将字符串Hello放入Windows剪贴板"><a href="#将字符串Hello放入Windows剪贴板" class="headerlink" title="将字符串Hello放入Windows剪贴板"></a>将字符串Hello放入Windows剪贴板</h3><blockquote>
<p>dir | clip</p>
<h3 id="将dir命令输出（当前目录列表）放入Windows剪贴板"><a href="#将dir命令输出（当前目录列表）放入Windows剪贴板" class="headerlink" title="将dir命令输出（当前目录列表）放入Windows剪贴板"></a>将dir命令输出（当前目录列表）放入Windows剪贴板</h3><p>clip &lt; README.TXT   </p>
<h3 id="将readme-txt的文本放入Windows剪贴板"><a href="#将readme-txt的文本放入Windows剪贴板" class="headerlink" title="将readme.txt的文本放入Windows剪贴板"></a>将readme.txt的文本放入Windows剪贴板</h3><p>echo | clip </p>
<h3 id="将一个空行放入Windows剪贴板，即清空Windows剪贴板"><a href="#将一个空行放入Windows剪贴板，即清空Windows剪贴板" class="headerlink" title="将一个空行放入Windows剪贴板，即清空Windows剪贴板"></a>将一个空行放入Windows剪贴板，即清空Windows剪贴板</h3></blockquote>
<p>#Linux下<br>使用xsel命令。</p>
<p>示例：</p>
<blockquote>
<p>cat README.TXT | xsel<br>cat README.TXT | xsel -b # 如有问题可以试试-b选项<br>xsel &lt; README.TXT </p>
</blockquote>
<h3 id="将readme-txt的文本放入剪贴板"><a href="#将readme-txt的文本放入剪贴板" class="headerlink" title="将readme.txt的文本放入剪贴板"></a>将readme.txt的文本放入剪贴板</h3><blockquote>
<p>xsel -c</p>
<h3 id="清空剪贴板"><a href="#清空剪贴板" class="headerlink" title="清空剪贴板"></a>清空剪贴板</h3></blockquote>
<p>#Mac下<br>使用pbcopy命令。 # 对应有个pbpaste命令。</p>
<p>示例：</p>
<p>tail file.txt | pbcopy</p>
<h3 id="将字符串放入剪贴板"><a href="#将字符串放入剪贴板" class="headerlink" title="将字符串放入剪贴板"></a>将字符串放入剪贴板</h3>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/linux/">linux</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2017/09/08/nodejs-http/"><span>nodejs-http</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2017/09/08/nodejs-http/" rel="bookmark">
        <time class="entry-date published" datetime="2017-09-08T12:48:51.000Z">
          2017-09-08
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>今天遇到场景，导出年级报告（pdf），一个页面需要中间层（node）向底层请求50+数量接口提供数据，因为接口数量过多，数据请求完成还后需要生成pdf。不管怎么请求都会超时，用户端都会超时，平均一个报告至少需要1分钟<br>甚至更长。</p>
<p>技术方案：</p>
<ul>
<li>Object.defineProperty set 避免深层回调</li>
<li>res.write(progress);    </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[javascript]</span><br><span class="line"></span><br><span class="line">let allUrlList = []//所有url接口</span><br><span class="line">let allDataObject = &#123;&#125;;</span><br><span class="line">let itemUrl = Object.defineProperty(&#123;&#125;, &quot;num&quot;, &#123;</span><br><span class="line">		set:function(num)&#123;</span><br><span class="line">			fetch(allUrlList[num],&#123;...postJson&#125;,(data)=&gt;&#123;</span><br><span class="line">			res.write(parseInt(num/allUrlList.length));</span><br><span class="line">			allDataObject.merge(data);</span><br><span class="line">			itemUrl.num = num+1;</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="http://iassets.oss-cn-beijing.aliyuncs.com/images/result.png" alt="图片"></p>
<font color="#ff0000">疑问：也希望各位大神能帮忙解惑，同样的等待时间，为什么不断的，res.write(progress)就不会超时了？</font>


<p>另外产生一个问题：因为等待时间比较长，用户会主动关闭页面或者返回等终端请求，服务端的接口依然是在请求，对一些资源有不必要的浪费.<br>因此又有了新的方案，如下代码<br>原理是侦听close事件，这里要注意不是abort; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[javascript]</span><br><span class="line">const http = require(&quot;http&quot;);</span><br><span class="line">const server = http.createServer(function(req,res)&#123;</span><br><span class="line">		res.writeHead(200,&#123;&apos;Content-type&apos;:&apos;text/html&apos;&#125;)</span><br><span class="line">	    if (req.url==&apos;\/favicon.ico&apos;) &#123;</span><br><span class="line">	    	res.end();</span><br><span class="line">	    	return;</span><br><span class="line">	    &#125;</span><br><span class="line">	    if(req.url==&apos;/test&apos;)&#123;</span><br><span class="line">	    	setTimeout(function()&#123;</span><br><span class="line">	    		res.write(&quot;test&quot;);</span><br><span class="line">	    		res.end()</span><br><span class="line">	    	&#125;,15000)</span><br><span class="line">	    &#125;;</span><br><span class="line">	    let i = 0;</span><br><span class="line">		let t = setInterval(function()&#123;</span><br><span class="line">			res.write(&quot;hello&quot;);</span><br><span class="line">			console.log(i);</span><br><span class="line">			if (i==10) &#123;</span><br><span class="line">				res.end();</span><br><span class="line">				clearInterval(t);</span><br><span class="line">			&#125;;</span><br><span class="line">			i++</span><br><span class="line">		&#125;,1000);</span><br><span class="line">		res.on(&apos;finish&apos;, function () &#123;</span><br><span class="line">	        console.log(&apos;server: response finish&apos;);</span><br><span class="line">	    &#125;);</span><br><span class="line">		res.on(&apos;close&apos;, function () &#123;</span><br><span class="line">       		 console.log(&apos;server: response close&apos;);</span><br><span class="line">       		 clearInterval(t);</span><br><span class="line">   		 &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server.listen(8032);</span><br><span class="line">server.on(&apos;listening&apos;,function()&#123;</span><br><span class="line">    console.log(&apos;ok, server is running&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/nodejs-http/">nodejs http</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2017/05/25/node-redis/"><span>nodejs链接redis实践</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2017/05/25/node-redis/" rel="bookmark">
        <time class="entry-date published" datetime="2017-05-25T03:18:39.000Z">
          2017-05-25
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>为了减轻服务底层一些压力以及业务需要，我们前端开始直接介入redis数据查询，为此又要开始充电了，距离实施还有一段时间,还是需要系统的研究下。下文如有什么错误希望各位老师帮忙指出。</p>
<p>准备工作，这里使用的是 <a href="https://www.npmjs.com/package/redis" target="_blank" rel="noopener">https://www.npmjs.com/package/redis</a></p>
<p>网络原因 尝试了多次安装最后还是用淘宝的镜像站安装成功了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save redis</span><br></pre></td></tr></table></figure>
<p>开始实践前要对 redis 有大概的了解，我就简单的说下我的拙见，<br>redis 也就是kv方式的储存数据，给我的感觉就是 临时、高效。当然这是我当做门外汉的理解。具体深入还是需要看专业的文章。</p>
<p>它有String、Hash、List、Set、Zset 五中数据格式 分别对应不同的方法</p>
<p>具体下面都会讲到<br>首先还是正确的链接redis</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[javascript]</span><br><span class="line">const redis = require(&quot;redis&quot;);</span><br><span class="line">const client = redis.createClient(&apos;6381&apos;, &apos;172.16.10.40&apos;); 端口号和ip地址</span><br><span class="line">client.auth(&quot;xxxxxxx&quot;);//认证 是一串字符，并不是key value的方式</span><br><span class="line">client.select(&quot;18&quot;,callback);// 18 redis 默认有18个数据库（可能跟设置，版本有关系数量不同，如下图所示） 选择一个数据库</span><br></pre></td></tr></table></figure>
<p> <img src="http://iassets.oss-cn-beijing.aliyuncs.com/images/20171209240.png" alt="18个数据库"></p>
<p>###String </p>
<p> 方法：</p>
<ul>
<li>client.set(key:string,value:string,[,EX,time(s)],redis.print);</li>
<li><p>client.get(key:string,callback);<br>如下代码所示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">client.set(&quot;test&quot;,&quot;hello redis&quot;,redis.print);//设置</span><br><span class="line">client.set(&quot;test&quot;,&quot;hello redis&quot;,&quot;EX&quot;,10,redis.print);//设置过期时间 10s</span><br><span class="line">client.get(&quot;test&quot;,(err,result)=&gt;&#123;&#125;)// result:hello word;</span><br><span class="line">client.del(&quot;test&quot;,()=&gt;&#123;console.log(arguments)&#125;)//删除</span><br></pre></td></tr></table></figure>
<p>如下图<br><img src="http://iassets.oss-cn-beijing.aliyuncs.com/images/20171209335.png" alt="插入"></p>
</li>
</ul>
<p>###Hash<br> 方法：</p>
<ul>
<li>client.hset(hashName:string, key, value, redis.print); 注意该方法可以多次向同一个hashName设置多个值</li>
<li>client.hgetall(hashName:string,callback);</li>
</ul>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">client.hset(&quot;testhash&quot;,&quot;key1&quot;,&quot;value1&quot;,redis.print);</span><br><span class="line">client.hset(&quot;testhash&quot;,&quot;key2&quot;,&quot;value2&quot;,redis.print);</span><br><span class="line">client.hgetall(&quot;testhash&quot;,callback)// &#123;&apos;key1&apos;:&apos;value1&apos;,&apos;key2&apos;:&apos;value2&apos;&#125;</span><br></pre></td></tr></table></figure>
<p>如下图<br><img src="http://iassets.oss-cn-beijing.aliyuncs.com/images/20171209338.png" alt="插入"></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/node-redis/">node redis</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2017/04/12/unicode-convert-with-javascript/"><span>unicode_convert_with_javascript</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2017/04/12/unicode-convert-with-javascript/" rel="bookmark">
        <time class="entry-date published" datetime="2017-04-12T05:01:46.000Z">
          2017-04-12
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>大众使用的方式</p>
<p><pre><br>function encodeunicode(data)<br>{<br>   if(data == ‘’) return ‘请输入汉字’;<br>   var str =’’;<br>   for(var i=0; i&lt;data.length;i++)<br>   {<br>      str+=”\\u”+parseInt(data[i].charCodeAt(0),10).toString(16);<br>   }<br>   return str;<br>}</pre></p>
<p>function decodeunicode(data)<br>{<br>    if(data == ‘’) return ‘请输入十六进制unicode’;<br>    data = data.split(“\u”);<br>    var str =’’;<br>    for(var i=0;i<data.length;i++) {="" str+="String.fromCharCode(parseInt(data[i],16).toString(10));" }="" return="" str;="" <="" pre=""><br>切记</data.length;i++)></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2016/05/22/mobile-ios-audio/"><span>mobile_ios_audio 自动播放的问题</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2016/05/22/mobile-ios-audio/" rel="bookmark">
        <time class="entry-date published" datetime="2016-05-22T12:18:59.000Z">
          2016-05-22
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>前几天整理的时候发现，原来的audio都不自动播放了，<br>阅读相关资料，才发现 </p>
<pre><code>苹果为了用户着想，禁止了Autoplay和JS &quot;onload&quot; 加载播放
</code></pre><p>也就是说，页面进来之后，不会自动加载音频文件，也不会自动播放，需要用户主动触发一下才可以正常加载，播放。</p>
<p>总结一下吧：</p>
<p>移动端Audio Autoplay</p>
<ul>
<li>苹果认为这是种不友好的行为</li>
</ul>
<p>细想一下 国内流量真的很贵的哟，不知道是不是因为这一点呢。 </p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/ios-audio-html/">ios audio html</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2016/04/13/dns-prefetch/"><span>DNS 预读取</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2016/04/13/dns-prefetch/" rel="bookmark">
        <time class="entry-date published" datetime="2016-04-13T14:07:07.000Z">
          2016-04-13
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>前些日子，对用户端的老师判题图片加了埋点时间统计，同时也统计了网站服务器在全国不同节点的速度情况，不同地方确实存在了一些差距，找了一些相关资料，发现了dns预读取方案。</p>
<p>X-DNS-Prefetch-Control 头控制着浏览器的 DNS 预读取功能。 DNS 预读取是一项使浏览器主动去执行域名解析的功能，其范围包括文档的所有链接，无论是图片的，CSS 的，还是 JavaScript 等其他用户能够点击的 URL。</p>
<p>因为预读取会在后台执行，所以 DNS 很可能在链接对应的东西出现之前就已经解析完毕。这能够减少用户点击链接时的延迟。</p>
<p>DNS 请求需要的带宽非常小，但是延迟却有点高，这点在手机网络上特别明显。预读取 DNS 能让延迟明显减少一些，例如用户点击链接时。在某些情况下，延迟能减少一秒钟。 </p>
<p>在某些浏览器中这个预读取的行为将会与页面实际内容并行发生（而不是串行）。正因如此，某些高延迟的域名的解析过程才不会卡住资源的加载。</p>
<p>这样可以极大的加速（尤其是移动网络环境下）页面的加载。在某些图片较多的页面中，在发起图片加载请求之前预先把域名解析好将会有至少 5% 的图片加载速度提升。</p>
<p>###在浏览器中设置预读取配置</p>
<p>一般来说并不需要去管理预读取，但是可能会有用户希望关闭预读取功能。这时只需要设置 network.dns.disablePrefetch preference 值为 true 就可以了。</p>
<p>另外，默认情况下，通过 HTTPS 加载的页面上内嵌链接的域名并不会执行预加载。在 Firefox 浏览器中，可以通过设置 network.dns.disablePrefetchFromHTTPS 值为 false 来改变这一默认行为。</p>
<p>###打开和关闭 DNS 预读取<br>你可以通过在服务器端发送 X-DNS-Prefetch-Control 报头，或是在文档中使用值为 http-equiv 的 <meta> 标签：</p>
<blockquote>
<p>\<meta http-equiv="x-dns-prefetch-control" content="off" \=""></p>
</blockquote>
<p>您可以通过将 content 的参数设置为“on”来改变设置。</p>
<p>###强制查询特定主机名<br>你可以通过使用 rel 属性值为 link type 中的 dns-prefetch 的 <link> 标签来对特定域名进行预读取：</p>
<blockquote>
<p>\<link rel="dns-prefetch" href="http://www.spreadfirefox.com /" \=""></p>
</blockquote>
<p>在这个例子中，Firefox将预解析域名”www.spreadfirefox.com”。</p>
<p>而且，<link> 元素也可以使用不完整的 URL 的主机名来标记预解析，但这些主机名前必需要有双斜线：</p>
<blockquote>
<p>\<link rel="dns-prefetch" href="//www.spreadfirefox.com"></p>
</blockquote>
<p>强制对域名进行预读取在有的情况下很有用, 比如, 在网站的主页上，强制在整个网站上频繁引用的域名的预解析，即使它们不在主页本身上使用。即使主页的性能可能不受影响，这将提<br>高整体站点性能。</p>
<p>小提示：</p>
<p>浏览器的DNS缓存<br>浏览器为了提高响应时间，也会缓存DNS记录。</p>
<p>这篇文章 列出了一些浏览器的DNS缓存时间</p>
<p>浏览器DNS缓存时间跟TTL无关，每种浏览器都有一个固定值</p>
<p>####chrome<br>为了加快访问速度，Google Chrome浏览器采用了预提DNS记录，在本地建立DNS缓存的方法，加快网站的连接速度。</p>
<p>chrome://net-internals/#dns 这里可以看各域名的DNS 缓存时间。chrome对每个域名会默认缓存60s。</p>
<p>####IE<br>IE将DNS缓存30min。见这里</p>
<p>####firefox<br>Firefox有dns缓存功能，但是默认缓存时间只有1分钟，可以通过修改该默认值加快DNS解析速度，方法如下：</p>
<p>打开一个新的窗口，地址栏输 入 about:config，回车，进入设置界面。然后搜索 network.dnsCacheExpiration ，把原来的60改成 6000（表示缓存6000秒），再搜索network.dnsCacheEntries 把默认的20改成1000（表示缓存1000条）。如果没 有上面两个项目，新建它们即可，</p>
<p>新建条目类型为整数型。 当然也可以按照需要设置成其它的值。</p>
<p>####safari<br>约为10s</p>
<p>原文地址：<a href="https://developer.mozilla.org/zh-CN/docs/Controlling_DNS_prefetching" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Controlling_DNS_prefetching</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/dns-prefetch/">dns prefetch</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2015/10/13/tessract-orc/"><span>识别图片文字</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2015/10/13/tessract-orc/" rel="bookmark">
        <time class="entry-date published" datetime="2015-10-13T14:47:58.000Z">
          2015-10-13
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>安装</p>
<blockquote>
<p>brew install tesseract        </p>
</blockquote>
<p>源代码安装</p>
<blockquote>
<p>git clone <a href="https://github.com/tesseract-ocr/tesseract.git" target="_blank" rel="noopener">https://github.com/tesseract-ocr/tesseract.git</a><br>./autogen.sh<br>./configure<br>make<br>make install<br>sudo ldconfig</p>
</blockquote>
<p>安装语言包</p>
<blockquote>
<p>brew install tesseract –all-languages    </p>
</blockquote>
<p>使用</p>
<blockquote>
<p>tesseract article.png  text -l chi_sim </p>
</blockquote>
<ul>
<li>article.png 提取文字的图片        </li>
<li>text 提取后 存放的文件  后缀名 .txt;        </li>
<li>-l chi_sim  语言 中文</li>
</ul>
<p>语言</p>
<ul>
<li>afr (Afrikaans) </li>
<li>amh (Amharic) </li>
<li>ara (Arabic) </li>
<li>asm (Assamese) </li>
<li>aze (Azerbaijani) </li>
<li>aze_cyrl (Azerbaijani - Cyrilic) </li>
<li>bel (Belarusian) </li>
<li>ben (Bengali) </li>
<li>bod (Tibetan) </li>
<li>bos (Bosnian) </li>
<li>bul (Bulgarian) </li>
<li>cat (Catalan; Valencian) </li>
<li>ceb (Cebuano) </li>
<li>ces (Czech) </li>
<li>chi_sim (Chinese - Simplified) </li>
<li>chi_tra (Chinese - Traditional) </li>
<li>chr (Cherokee) </li>
<li>cym (Welsh) </li>
<li>dan (Danish) </li>
<li>dan_frak (Danish - Fraktur) </li>
<li>deu (German) </li>
<li>deu_frak (German - Fraktur) </li>
<li>dzo (Dzongkha) </li>
<li>ell (Greek, Modern (1453-)) </li>
<li>eng (English) </li>
<li>enm (English, Middle (1100-1500)) </li>
<li>epo (Esperanto) </li>
<li>equ (Math / equation detection module) </li>
<li>est (Estonian) </li>
<li>eus (Basque) </li>
<li>fas (Persian) </li>
<li>fin (Finnish) </li>
<li>fra (French) </li>
<li>frk (Frankish) </li>
<li>frm (French, Middle (ca.1400-1600)) </li>
<li>gle (Irish) </li>
<li>glg (Galician) </li>
<li>grc (Greek, Ancient (to 1453)) </li>
<li>guj (Gujarati) </li>
<li>hat (Haitian; Haitian Creole) </li>
<li>heb (Hebrew) </li>
<li>hin (Hindi) </li>
<li>hrv (Croatian) </li>
<li>hun (Hungarian) </li>
<li>iku (Inuktitut) </li>
<li>ind (Indonesian) </li>
<li>isl (Icelandic) </li>
<li>ita (Italian) </li>
<li>ita_old (Italian - Old) </li>
<li>jav (Javanese) </li>
<li>jpn (Japanese) </li>
<li>kan (Kannada) </li>
<li>kat (Georgian) </li>
<li>kat_old (Georgian - Old) </li>
<li>kaz (Kazakh) </li>
<li>khm (Central Khmer) </li>
<li>kir (Kirghiz; Kyrgyz) </li>
<li>kor (Korean) </li>
<li>kur (Kurdish) </li>
<li>lao (Lao) </li>
<li>lat (Latin) </li>
<li>lav (Latvian) </li>
<li>lit (Lithuanian) </li>
<li>mal (Malayalam) </li>
<li>mar (Marathi) </li>
<li>mkd (Macedonian) </li>
<li>mlt (Maltese) </li>
<li>msa (Malay) </li>
<li>mya (Burmese) </li>
<li>nep (Nepali) </li>
<li>nld (Dutch; Flemish) </li>
<li>nor (Norwegian) </li>
<li>ori (Oriya) </li>
<li>osd (Orientation and script detection module) </li>
<li>pan (Panjabi; Punjabi) </li>
<li>pol (Polish) </li>
<li>por (Portuguese) </li>
<li>pus (Pushto; Pashto) </li>
<li>ron (Romanian; Moldavian; Moldovan) </li>
<li>rus (Russian) </li>
<li>san (Sanskrit) </li>
<li>sin (Sinhala; Sinhalese) </li>
<li>slk (Slovak) </li>
<li>slk_frak (Slovak - Fraktur) </li>
<li>slv (Slovenian) </li>
<li>spa (Spanish; Castilian) </li>
<li>spa_old (Spanish; Castilian - Old) </li>
<li>sqi (Albanian) </li>
<li>srp (Serbian) </li>
<li>srp_latn (Serbian - Latin) </li>
<li>swa (Swahili) </li>
<li>swe (Swedish) </li>
<li>syr (Syriac) </li>
<li>tam (Tamil) </li>
<li>tel (Telugu) </li>
<li>tgk (Tajik) </li>
<li>tgl (Tagalog) </li>
<li>tha (Thai) </li>
<li>tir (Tigrinya) </li>
<li>tur (Turkish) </li>
<li>uig (Uighur; Uyghur) </li>
<li>ukr (Ukrainian) </li>
<li>urd (Urdu) </li>
<li>uzb (Uzbek) </li>
<li>uzb_cyrl (Uzbek - Cyrilic) </li>
<li>vie (Vietnamese) </li>
<li>yid (Yiddish)</li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2015/09/08/imagemagick/"><span>ImageMagick教程</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2015/09/08/imagemagick/" rel="bookmark">
        <time class="entry-date published" datetime="2015-09-08T03:59:03.000Z">
          2015-09-08
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>####拼图</p>
<blockquote>
<p>montage ./*.png -tile 50x20 -geometry 32x32  icons.png</p>
</blockquote>
<p>-tile x轴50个  y轴 20个<br>-geometry 32x32 长宽 各32        </p>
<p>ImageMagick操作之图片高级操作</p>
<p>1、图片指定区域变色<br>指定区域尺寸和起始坐标（50x60+20+10）、区域颜色（rgb(255,0,0)）、着色程度（20%）。</p>
<blockquote>
<p>convert old.png -region 50x60+20+10 -fill “rgb(255,0,0)” -colorize 20% new.png<br>convert 2.jpg -region 150x100+20+10 -fill “rgb(255,0,0)” -colorize 20% new.png</p>
</blockquote>
<p>2、图片指定区域变色（放大或缩小区域）<br>指定区域尺寸和起始坐标（50x60+20+10）、尺寸（120%）、区域颜色（rgb(255,0,0)）、着色程度（20%）。</p>
<blockquote>
<p>convert old.png -region 50x60+20+10 -resize 120% -fill “rgb(255,0,0)” -colorize 20% new.png</p>
</blockquote>
<p>3、替换相同颜色的区域（指定颜色）<br>指定颜色差异程度（10%），替换颜色（黑色），被替换颜色（白色）。将整张图片中的指定颜色全部替换。</p>
<blockquote>
<p>convert 2.jpg -alpha set -channel RGBA -fuzz 10% -fill “rgb(0,0,0)” -opaque “rgb(255,255,255)” new.png</p>
</blockquote>
<p>4、替换不同颜色的区域（指定颜色）<br>指定颜色差异程度（50%），替换颜色（白色），指定颜色（蓝色）。将整张图片中除指定颜色外的颜色全部替换。</p>
<blockquote>
<p>convert 2.jpg -alpha set -channel RGBA -fuzz 50% -fill “rgb(255,255,255)” +opaque “rgb(0,0,255)” new.png</p>
</blockquote>
<p>5、替换相同颜色的区域（指定坐标）<br>指定颜色差异程度（10%），替换颜色（红色），指定坐标（180,150）。将整张图片中与指定位置颜色相同的颜色全部替换。</p>
<blockquote>
<p>convert 2.jpg -alpha set -channel RGBA -fuzz 10% -fill “rgb(255,0,0)” -draw “color 180,150 replace” new.png</p>
</blockquote>
<p>6、替换相同颜色的连通区域（指定坐标）<br>指定颜色差异程度（10%），替换颜色（红色），指定坐标（180,150）。将图片连通区域中与指定位置颜色相同的颜色全部替换。</p>
<blockquote>
<p>convert 2.jpg -alpha set -channel RGBA -fuzz 10% -fill “rgb(255,0,0)” -draw “color 180,150 replace” new.png</p>
</blockquote>
<p>7、图像边缘突出显示<br>指定探测半径（5），对图像中类似边缘的像素进行探测。使边缘突显出来，易于观察。</p>
<blockquote>
<p>convert old.png -edge 5 new.png</p>
</blockquote>
<p>8、图像边缘探测<br>指定探测半径（5）。</p>
<blockquote>
<p>convert 2.jpg -background white -flatten -colorspace gray -negate -edge 5 -negate -normalize -threshold 50% -despeckle -blur 0x.5 -contrast-stretch 0x50% new.png</p>
</blockquote>
<p>##合并图片</p>
<blockquote>
<p>composite -gravity north src.jpg coverback.jpg des.jpg</p>
</blockquote>
<p>其中src.jpg为前景图片</p>
<p>coverback.jpg为背景图片。</p>
<p>des.jpg为叠加后的结果</p>
<p>##生成 ico</p>
<blockquote>
<p>convert logo.png -background none favicon.ico</p>
</blockquote>
<p>##获取图片信息</p>
<blockquote>
<p>identify image.png<br>identify -format “%wx%h” image.png  //只获取宽高</p>
</blockquote>
<p>##放大缩小</p>
<blockquote>
<p>convert image.png -resize 200x200 resize.png<br>convert image.png -resize 50% resize.png<br>convert image.png -sample 50% sample.png   //用来生成缩略图最合适<br>convert image.png -sample 10% -sample 1000% sample.png //处理马赛克</p>
</blockquote>
<p>##裁剪 -crop</p>
<blockquote>
<p>convert image.png -crop 100x100+50+50 crop.png //从（50，50）位置开始，裁剪一个100X100大小的图片：<br>convert image.png -crop 100x100 crop.png<br>convert image.png -gravity northeast -crop 100x100+0+0 crop.png </p>
</blockquote>
<ul>
<li>-gravity即指定坐标原点，    </li>
<li>northwest：左上角，    </li>
<li>north：上边中间，        </li>
<li>northeast：右上角，    </li>
<li>east：右边中间    </li>
</ul>
<p>##旋转 -rotate</p>
<blockquote>
<p>convert image.png -rotate 45 rotate.png  </p>
</blockquote>
<p>##合并</p>
<blockquote>
<p>convert image.png -compose over overlay.png -composite newimage.png</p>
</blockquote>
<p>##更改图片的alpha通道</p>
<blockquote>
<p>convert image.png -define png:format=png32  image32.png<br>convert image32.png -channel alpha -fx “0.5” imagealpha.png  </p>
</blockquote>
<p>##拼接</p>
<blockquote>
<p>convert image1.png image2.png image3.png -gravity south +append result.png </p>
</blockquote>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/ImageMagick/">ImageMagick</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/blog/2015/05/15/wxpay/"><span>微信支付注意事项</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2015/05/15/wxpay/" rel="bookmark">
        <time class="entry-date published" datetime="2015-05-15T13:50:21.000Z">
          2015-05-15
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>####准备工作 </p>
<ul>
<li>appid 公众号id</li>
<li>mch_id 商户号 公众号申请微信支付成功后 会有个商户号</li>
<li>key 密钥 申请成功后会收到邮件 会带着密钥 用于签名</li>
</ul>
<p>####配置环境：</p>
<ul>
<li>配置支付目录（开发，生产环境）</li>
<li>配置支付成功回调地址</li>
</ul>
<p>####开发</p>
<ul>
<li>获取prepay_id 首先根据统一下单接口获取<br>注意：<br>1、区分大小写<br>2、排序    </li>
</ul>
<blockquote>
<p>let item = {}<br>   Object.keys(json).sort().map(function(key) {<br>       item[key] = json[key];<br>   });</p>
</blockquote>
<p>3、拼接 (记得加上 key) 放在最后就行</p>
<blockquote>
<p>querystring.stringify(json) </p>
</blockquote>
<p>4、签名 md5 记得转换大写</p>
<blockquote>
<p>let t = crypto.createHash(“md5”);<br>t.update(url, “utf8”, “hex”);<br>t.digest(“hex”).toUpperCase();</p>
</blockquote>
<p>5、增加sign字段<br>6、请求的时候 记得转换xml </p>
<ul>
<li>h5发起支付<br> 签名注意<br> 1、时间戳记得转换成字符串  ios会提示有问题<br> 2、记得加上key</li>
</ul>
<p>未完待续~~~~</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  
  <a href="/blog/page/2/" class="pagination-next">Next</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2018 ibeeger
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>